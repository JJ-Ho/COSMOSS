function hF = Plot_Betasheet_AmideI(Structure,varargin)
%% PlotXYZfiles
%  
% Given the Stuctural infomation that generated by GetAmideI.m this
% function can plot the molecule and its' amide I modes.
% 
% ------- Version log -----------------------------------------------------
% 
% Ver. 1.4  140605  Readuce the process for reading XYZ data
% 
% Ver. 1.3  131107  Add imput "Rot_Mat" to rotate molecue as user assigned
%                   This is the correction follow by v1.2 of
%                   OneDSFG_AmideI.m
% 
% Ver. 1.2  130930  Move gplot3 from Molecular_Plot to here to accomodate
%                   the update of molecular_plot
% 
% Ver. 1.1  130814  Bug in atom position index fixed 
% 
% Ver. 1.0  130729  Isolated from TwoDSFG_Simulation
% 
% ------------------------------------------------------------------------
% Copyright Jia-Jung Ho, 2013

%% Debug
% clear all 
% 
% XYZ      = ConstuctBetaSheet(10,2);
% Structure = GetAmideI_CON_XYZ_betasheet(XYZ);

%% Input parser
% INPUT = inputParser;
% INPUT.KeepUnmatched = 1;
% 
% % Default values
% default_hF = 'New';
% 
% % Add optional inputs to inputparser object
% addOptional(INPUT,'hF',default_hF);
% 
% parse(INPUT,varargin{:});
% 
% hF = INPUT.Results.hF  ;


%% Main

% Rotate molecule and transition dipole 
XYZ        = Structure.XYZ;
Rot_Center = Structure.center;
Rot_mu     = Structure.mu;

% permute and Reshape XYZ
R_1 = reshape(XYZ,[],3,3);
R = permute(R_1,[1,3,2]);

% Scale TDV vector in plot
Rot_mu_S = Rot_mu./10;

% draw molecule


hF = figure;


hold on
Conn = Connectivity(R,'BondLength',7);
gplot3(Conn,R);
axis equal;
rotate3d on


Carbon_Pos   = R(:,:,1);
Oxygen_Pos   = R(:,:,2);
Nitrogen_Pos = R(:,:,3);

% line(Test_X',Test_Y',Test_Z','LineWidth',2)
quiver3(Rot_Center(:,1),Rot_Center(:,2),Rot_Center(:,3),...
        Rot_mu_S(:,1),Rot_mu_S(:,2),Rot_mu_S(:,3),0,...
        'LineWidth',2,...
        'Color',[0 1 0]);

plot3(Rot_Center(:,1)  ,Rot_Center(:,2)  ,Rot_Center(:,3)  ,'LineStyle','none','Marker','d','MarkerFaceColor','w')
plot3(Carbon_Pos(:,1)  ,Carbon_Pos(:,2)  ,Carbon_Pos(:,3)  ,'LineStyle','none','Marker','o','MarkerFaceColor','k','MarkerSize',10)
plot3(Oxygen_Pos(:,1)  ,Oxygen_Pos(:,2)  ,Oxygen_Pos(:,3)  ,'LineStyle','none','Marker','o','MarkerFaceColor','r','MarkerSize',10)
plot3(Nitrogen_Pos(:,1),Nitrogen_Pos(:,2),Nitrogen_Pos(:,3),'LineStyle','none','Marker','o','MarkerFaceColor','b','MarkerSize',10)

hold off

xlabel('X')
ylabel('Y')